/*
 * This Java source file was generated by the Gradle 'init' task.
 */

package ChemSafetyAsst;
import static spark.Spark.*;
import Chemical.Chemical;
import java.io.*;
import java.net.URI;
import java.net.http.*;

public class App {
    public String getGreeting() {
        return "Hello World! Test";
    }

    public static void main(String[] args) {
        System.out.println(new App().getGreeting());
        
        HttpClient client = HttpClient.newBuilder().build();
        
        get("/testrequest", (req, res) -> {
            HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create("https://pubchem.ncbi.nlm.nih.gov/rest/pug/substance/sid/53789435/synonyms/json"))
            .build();
            HttpResponse response;
            try {
                response = client.send(
                    request, HttpResponse.BodyHandlers.ofString()
                    );
            } catch (IOException e) {
                // gotBack = "?";
                System.out.println("IO exception occurred");
                return "error";
            }
            return response.body();
        });

        get("/hello", (req, res) -> "Hello World");
        get("/stop", (req, res) -> {
            stop();
            return "stopping";
        });
        get("/identifier/:id", (req, res)-> {
            Chemical c = new Chemical(req.params(":id"));
            return c.printIdentifier();
        });
    }
}
